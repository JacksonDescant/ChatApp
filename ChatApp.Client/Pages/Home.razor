@page "/"
@using ChatApp.Models
@inject HttpClient Http

<PageTitle>Home</PageTitle>

<h1>Hello</h1>

Welcome to ChatApp!

@if (LoggedIn)
{
<p>Welcome, @username!</p>
}
else
{
<EditForm Model="this" OnValidSubmit="Login">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="form-group">
        <label for="username">Username:</label>
        <InputText id="username" class="form-control" @bind-Value="username" />
    </div>

    <div class="form-group">
        <label for="password">Password:</label>
        <InputText id="password" type="password" class="form-control" @bind-Value="password" />
    </div>

    <button type="submit" class="btn btn-primary">Login</button>
</EditForm>
}

@code{

    private string username;
    private string password;
    private bool LoggedIn = false;

    private async Task Login()
    {
        var userInfo = new UserInfo { Username = username, Password = password };
        var response = await Http.PostAsJsonAsync("UserInfo/authenticate", userInfo);
        
        if (response.IsSuccessStatusCode)
        {
            LoggedIn = true;
        }
        
        
    }

}